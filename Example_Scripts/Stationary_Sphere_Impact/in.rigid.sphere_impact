# Create a single stationary abradable particles and impact it with a spherical atom

###############################################
# Variable Definitions
###############################################


# Variables
variable E equal 4.76*0.1 # Youngs modulus [GPa]
variable poisson equal 0.4 # Poisson Ratio [-]
variable G equal ${E}/(2*(1+${poisson})) # Shear modulus [GPa]
variable kn equal (4*${G}/(3*((1-${poisson}))))*(1e+10) # Normal Elastic Constant
variable kt equal (4*${G}/(2-${poisson}))*(1e+10) # Tangential Elastic Constant
variable e equal 0.55 # Coefficient of Restitution [-]
variable xmu equal 0.39 # Friction Coefficient [-]
variable damp_flag equal 1
variable density equal 1.42 # Mass density [g/cm^3]

# Hardnesses have been greatly reduced to unphysical values for demonstration purposes
variable H_input equal 0.01 # Indentation Hardness [GPa]
variable H equal ${H_input}*(1e+10) # [dyne/cm^2]
variable mu equal 0.25 # Scratching/Indentation Hardness Ratio [-]
variable dt equal 5.0e-7 # s

###############################################
# Initialisation
###############################################
units           cgs 
boundary        p p p
atom_style      hybrid molecular sphere
dimension       3
newton          on

###############################################
# Creating the simulation box
###############################################

processors * * *

region boundingBox block -5 5 -5 5 -5 5 units box side in
create_box 4 boundingBox angle/types 1 extra/angle/per/atom 10

###############################################
# Particle-related parameters
###############################################
angle_style	zero
angle_style	zero
angle_coeff	* 75.0

# Reading in the cube mol file
molecule Cube Cube.mol
variable natoms_per_body equal 387

###############################################
# Pre-fix Settings
###############################################
neighbor 0.2 multi  
comm_modify mode multi vel yes 
â€‹compute t1 all temp/sphere
thermo_modify temp t1

pair_style granular
pair_coeff * * hertz ${kn} ${e} tangential linear_history ${kt} 1.0 ${xmu} damping coeff_restitution limit_damping

timestep ${dt}

###############################################
# Particle Creation
###############################################

create_atoms 0 single  0.0 0.0 0.0 mol Cube 1729871 rotate 0.0 1.0 0.0 0.0 units box
create_atoms 2 single 3.0 0.0 0.0 units box

group none type 0
# Isolating each body's owning atom (placed at their centres) to specify hybrid neighbor list
group owning id 1:5000:${natoms_per_body} 
group owned subtract all owning 
set group owning type 4 
neigh_modify collection/type 2 *3, 4 
comm_modify cutoff/multi 1 0.0 cutoff/multi 2 5.0 

group abradable_cube molecule 1

group projectile id 388
velocity projectile set -5000 0.0 0.0
set group projectile diameter 2
###############################################
# Fix Definitions
###############################################

fix 1 projectile nve/sphere
fix abrade abradable_cube rigid/abrade ${H} 0.25 ${density} molecule normals stationary
###############################################
# Running Simulation
###############################################

#                                                                   associated_area  cumulative_displacement     normal_x    normal_y     normal_z
dump 1 all custom 50 dump.pos id x y z radius vx vy vz fx fy fz      f_abrade[4]         f_abrade[8]          f_abrade[9] f_abrade[10] f_abrade[11] 

run 1000





